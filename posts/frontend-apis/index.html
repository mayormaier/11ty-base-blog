<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrating APIs with JavaScript in the Front End</title>
    <meta name="description" content="Connecting front end applications to multiple APIs">
    <link rel="stylesheet" href="/11ty-base-blog/css/index.css">
    <link rel="stylesheet" href="/11ty-base-blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/11ty-base-blog/feed/feed.xml" type="application/atom+xml" title="Andrew Maier Blog">
    <link rel="alternate" href="/11ty-base-blog/feed/feed.json" type="application/json" title="Andrew Maier Blog">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/11ty-base-blog/">Andrew Maier Blog</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/11ty-base-blog/">Home</a></li>
        <li class="nav-item"><a href="/11ty-base-blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/11ty-base-blog/about/">About Me</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Integrating APIs with JavaScript in the Front End</h1>

<time datetime="2022-02-28">28 Feb 2022</time><a href="/11ty-base-blog/tags/javascript/" class="post-tag">javascript</a><a href="/11ty-base-blog/tags/webdev/" class="post-tag">webdev</a><a href="/11ty-base-blog/tags/frontend/" class="post-tag">frontend</a><a href="/11ty-base-blog/tags/api/" class="post-tag">api</a>

<h2 id="fetch-and-the-power-of-apis" tabindex="-1">Fetch and the Power of APIs <a class="direct-link" href="#fetch-and-the-power-of-apis" aria-hidden="true">#</a></h2>
<p><code>fetch()</code> is an <em>asynchronous</em> JavaScript function that allows client-side web applications to make HTTP Requests to a web endpoint. This is most commonly used to make API calls from the browser.</p>
<p>Asynchronous functions are known as &quot;non-blocking&quot;. Rather than taking up a processing thread while waiting for a return value, non-blocking functions allow other operations to execute in the program. This results in much more responsive applications.</p>
<p>Fetch's asynchronous property is enables it to free the processing thread while waiting for an API response. This is a great way of handing API calls, as responses can vary in speed depending on the destination server and application.</p>
<pre class="language-js"><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://example.com/movies.json'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><em>the above example is courtesy of Mozilla</em></p>
<p>The fetch method is relatively simple. In its most basic form, <code>fetch()</code> has one parameter, the URL of the HTTP endpoint. Other parameters can be added to send data to an endpoint (i.e., JSON for a HTTP PUT request). This enables developers to fully leverage API requests in their front end applications.</p>
<p>In the example above, an HTTP GET request was made, which returns data from the server to the client. After the response returns successfully, the <code>.then()</code> functions parse the response as JSON, then print it to the console. However, console logging is not the only thing that can be accomplished in this function.</p>
<p><code>.then()</code> clauses can also be used to pull data from the API response and set it as a variable. For example, in the application presented in this example, the responses from  <a href="https://www.freegeoip.app/json">freegeoip.app/json</a> are used to identify the location of a user at a specific IP address. The <code>latitude</code> <code>longitude</code> <code>city</code> and <code>region_name</code> fields are all variables that the API returns and are tracked by the application. Here's an example of the JSON data returned by the API:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br><span class="token property">"ip"</span><span class="token operator">:</span> <span class="token string">"104.38.28.100"</span><span class="token punctuation">,</span><br><span class="token property">"country_code"</span><span class="token operator">:</span> <span class="token string">"US"</span><span class="token punctuation">,</span><br><span class="token property">"country_name"</span><span class="token operator">:</span> <span class="token string">"United States"</span><span class="token punctuation">,</span><br><span class="token property">"region_code"</span><span class="token operator">:</span> <span class="token string">"PA"</span><span class="token punctuation">,</span><br><span class="token property">"region_name"</span><span class="token operator">:</span> <span class="token string">"Pennsylvania"</span><span class="token punctuation">,</span><br><span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"University Park"</span><span class="token punctuation">,</span><br><span class="token property">"zip_code"</span><span class="token operator">:</span> <span class="token string">"16802"</span><span class="token punctuation">,</span><br><span class="token property">"time_zone"</span><span class="token operator">:</span> <span class="token string">"America/New_York"</span><span class="token punctuation">,</span><br><span class="token property">"latitude"</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span><br><span class="token property">"longitude"</span><span class="token operator">:</span> <span class="token number">-77</span><span class="token punctuation">,</span><br><span class="token property">"metro_code"</span><span class="token operator">:</span> <span class="token number">574</span><br><span class="token punctuation">}</span></code></pre>
<p><em>This JSON blob is sample API response from the <a href="https://www.freegeoip.app/json">freegeoip.app/json</a> API.</em></p>
<h2 id="element-variables-and-rendering" tabindex="-1">Element Variables and Rendering <a class="direct-link" href="#element-variables-and-rendering" aria-hidden="true">#</a></h2>
<p>Variable assignment in the <code>then()</code> method calls enables stateful updating of the application. Each time that the API is called and returns data successfully, the instance variables are updated, and the DOM is re-painted with the new data. The render() function determines how the page will be displayed each time that the DOM is painted. Not all variables in the application achieve this behavior- only variables defined in the <code>static get properties()</code> method trigger the DOM to be re-painted. Note: you can also generate new variables based on the variables that are returned by an API call. For example, I set location equal to <code>$city, $region_name</code> which is used many other times in the application.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">reflect</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">long</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">reflect</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">reflect</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">region</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">reflect</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">reflect</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span></code></pre>
<p><em>The properties defined in this method trigger the DOM to be re-painted</em></p>
<p>Let's discuss the <code>&lt;location-from-ip&gt;</code> component in more depth. Firstly, the properties listed above populate the component with the data that it needs to render. The data relies on APIs to populate. The <code>getGEOIPData()</code> function includes all of the logic to obtain these data points.</p>
<p>Firstly, a <code>UserIP</code> object instance is created to identify the IP address of the user. This relies on an API that returns the IP of the user making the request. This IP addres data is then fed into another API (<a href="https://www.freegeoip.app/">freegeoip.app</a>) that takes the IP address from the user and returns location data about that IP address. See the example API response above. After the response is retuned, the given variables are updated which triggers a repainting of the DOM. This update feeds those new variables into a number of services defined in the <code>render()</code> function:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://maps.google.com/maps?q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>lat<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>long<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;t=&amp;z=15&amp;ie=UTF8&amp;iwloc=&amp;output=embed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;iframe title="Where you are" src="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">&lt;/iframe><br>      &lt;br />&lt;a<br>        href="https://www.google.com/maps/@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>lat<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>long<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,15z"<br>        target="_blank"<br>        >Expand Map to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a<br>      ><br>      &lt;br />&lt;br /><br>      &lt;wikipedia-query search="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">&lt;/wikipedia-query><br>      &lt;wikipedia-query search="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>city<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">&lt;/wikipedia-query><br>      &lt;wikipedia-query search="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>region<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">&lt;/wikipedia-query><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre>
<ol>
<li>The <code>lat</code> and <code>long</code> variables are inserted into an Google Maps embed link that populates an <code>&lt;iframe&gt;</code>.</li>
<li>The <code>lat</code>, <code>long</code> and <code>location</code> variables are used to populate a hyperlink that opens the location in the full Google Maps site.</li>
<li>The <code>&lt;wikipedia-query&gt;</code> web component is leveraged to provide articles about the location determined by the GEOIP API. The compnent relies on a <code>search</code> property that defines the wikipedia page to display. There are three <code>&lt;wikipedia-query&gt;</code> tags total. One uses the <code>location</code> property as the search string, and the other two use <code>city</code> and <code>region</code>.</li>
</ol>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/tqtzywaadnkkyumy56ri.png" alt="Image description"><br>
<em>The <code>&lt;location-from-ip&gt;</code> element, visually</em></p>
<p>Ultimately, the use of APIs within web components can be achieved with ease and is a great way to add responsive elements to a static site.</p>
<p>For more information about the API used in this application, see <a href="https://www.freegeoip.app/">freegeoip.app</a>, <a href="https://codepen.io/btopro/pen/yLNmVbw">wikipedia element</a>, <a href="https://ip-fast.com/api/ip/">IPFast IP Address API</a></p>
<p>Check out the <a href="https://github.com/mayormaier/API-Project/blob/master/src/LocationFromIP.js">application repository here</a></p>
<h4 id="sources" tabindex="-1">Sources <a class="direct-link" href="#sources" aria-hidden="true">#</a></h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Concepts">General asynchronous programming concepts - MDN Web Docs</a><br>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">Using Fetch - MDN Web Docs</a></p>

<hr>
<ul><li>Next: <a href="/11ty-base-blog/posts/webcomponent-intro/">Getting Started with open-wc and Web Components</a></li><li>Previous: <a href="/11ty-base-blog/posts/11ty/">How to build powerful sites from scratch with 11ty</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /11ty-base-blog/posts/frontend-apis/ -->
  </body>
</html>
